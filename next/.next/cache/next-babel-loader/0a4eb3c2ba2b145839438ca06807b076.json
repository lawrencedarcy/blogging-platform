{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/lawrence_wakefield/Documents/Development/codeworks/final-project/blogging-platform/next/pages/secret.js\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport axios from 'axios';\nimport { Cookies } from 'react-cookie';\nimport { handleAuthSSR } from '../utils/auth';\nvar serverUrl = 'http://localhost:3001'; // set up cookies\n\nvar cookies = new Cookies();\n\nvar Secret = /*#__PURE__*/function (_React$Component) {\n  _inherits(Secret, _React$Component);\n\n  var _super = _createSuper(Secret);\n\n  function Secret() {\n    var _this;\n\n    _classCallCheck(this, Secret);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"onPingCall\", function _callee(e) {\n      var token, res;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              token = cookies.get('token');\n              _context.prev = 1;\n              _context.next = 4;\n              return _regeneratorRuntime.awrap(axios.get(serverUrl + '/api/ping', {\n                headers: {\n                  'Authorization': token\n                }\n              }));\n\n            case 4:\n              res = _context.sent;\n              console.log(res.data.msg);\n              _context.next = 11;\n              break;\n\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](1);\n              console.log(_context.t0.response.data.msg);\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, [[1, 8]], Promise);\n    });\n\n    return _this;\n  }\n\n  _createClass(Secret, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return __jsx(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 26,\n          columnNumber: 7\n        }\n      }, __jsx(\"h2\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 27,\n          columnNumber: 9\n        }\n      }, \"Secret page\"), __jsx(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 28,\n          columnNumber: 9\n        }\n      }, \"Only accessible via a valid JWT\"), __jsx(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 29,\n          columnNumber: 9\n        }\n      }), __jsx(\"button\", {\n        onClick: function onClick(e) {\n          return _this2.onPingCall(e);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 30,\n          columnNumber: 9\n        }\n      }, \"Ping Call\"), __jsx(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 31,\n          columnNumber: 9\n        }\n      }, \"Check console for response\"));\n    }\n  }]);\n\n  return Secret;\n}(React.Component); // Server-Side Rendering\n\n\nSecret.getInitialProps = function _callee2(ctx) {\n  return _regeneratorRuntime.async(function _callee2$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.next = 2;\n          return _regeneratorRuntime.awrap(handleAuthSSR(ctx));\n\n        case 2:\n          return _context2.abrupt(\"return\", {});\n\n        case 3:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};\n\nexport default Secret;","map":{"version":3,"sources":["/Users/lawrence_wakefield/Documents/Development/codeworks/final-project/blogging-platform/next/pages/secret.js"],"names":["React","axios","Cookies","handleAuthSSR","serverUrl","cookies","Secret","e","token","get","headers","res","console","log","data","msg","response","onPingCall","Component","getInitialProps","ctx"],"mappings":";;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,OAAT,QAAwB,cAAxB;AACA,SAASC,aAAT,QAA8B,eAA9B;AAEA,IAAMC,SAAS,GAAG,uBAAlB,C,CAEA;;AACA,IAAMC,OAAO,GAAG,IAAIH,OAAJ,EAAhB;;IAEMI,M;;;;;;;;;;;;;;;;iEAES,iBAAOC,CAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACLC,cAAAA,KADK,GACGH,OAAO,CAACI,GAAR,CAAY,OAAZ,CADH;AAAA;AAAA;AAAA,+CAISR,KAAK,CAACQ,GAAN,CAAUL,SAAS,GAAG,WAAtB,EAAmC;AAAEM,gBAAAA,OAAO,EAAE;AAAE,mCAAiBF;AAAnB;AAAX,eAAnC,CAJT;;AAAA;AAIHG,cAAAA,GAJG;AAKTC,cAAAA,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,IAAJ,CAASC,GAArB;AALS;AAAA;;AAAA;AAAA;AAAA;AAOTH,cAAAA,OAAO,CAACC,GAAR,CAAY,YAAIG,QAAJ,CAAaF,IAAb,CAAkBC,GAA9B;;AAPS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;;;;;;6BAWJ;AAAA;;AACP,aACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2CAFF,EAGE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAHF,EAIE;AAAQ,QAAA,OAAO,EAAE,iBAACR,CAAD;AAAA,iBAAO,MAAI,CAACU,UAAL,CAAgBV,CAAhB,CAAP;AAAA,SAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAJF,EAKE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sCALF,CADF;AASD;;;;EAvBkBP,KAAK,CAACkB,S,GA0B3B;;;AACAZ,MAAM,CAACa,eAAP,GAAyB,kBAAOC,GAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2CAKjBjB,aAAa,CAACiB,GAAD,CALI;;AAAA;AAAA,4CAQhB,EARgB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAzB;;AAWA,eAAed,MAAf","sourcesContent":["import React from 'react';\nimport axios from 'axios';\nimport { Cookies } from 'react-cookie';\nimport { handleAuthSSR } from '../utils/auth';\n\nconst serverUrl = 'http://localhost:3001';\n\n// set up cookies\nconst cookies = new Cookies();\n\nclass Secret extends React.Component {\n\n  onPingCall = async (e) => {\n    const token = cookies.get('token')\n\n    try {\n      const res = await axios.get(serverUrl + '/api/ping', { headers: { 'Authorization': token } });\n      console.log(res.data.msg);\n    } catch (err) {\n      console.log(err.response.data.msg);\n    }\n  }\n\n  render() {\n    return (\n      <div>\n        <h2>Secret page</h2>\n        <p>Only accessible via a valid JWT</p>\n        <br></br>\n        <button onClick={(e) => this.onPingCall(e)}>Ping Call</button>\n        <p>Check console for response</p>\n      </div>\n    );\n  }\n}\n\n// Server-Side Rendering\nSecret.getInitialProps = async (ctx) => {\n  // Must validate JWT\n  // If the JWT is invalid it must redirect\n  // back to the main page. You can do that\n  // with Router from 'next/router\n  await handleAuthSSR(ctx);\n\n  // Must return an object\n  return {}\n}\n\nexport default Secret;"]},"metadata":{},"sourceType":"module"}