{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport Dashboard from '../components/Dashboard/Dashboard';\n\nfunction App({\n  postList,\n  tags,\n  auth\n}) {\n  const {\n    0: posts,\n    1: setPosts\n  } = useState([]);\n  const {\n    0: feed,\n    1: setFeed\n  } = useState('normal');\n  useEffect(() => {\n    setPosts(postList);\n    setFeed('normal');\n  }, []);\n\n  const getPostByTag = async tag => {\n    await axios.get(`http://localhost:3001/posts/${tag}`).then(data => {\n      setPosts(data.data);\n      setFeed('tags');\n    });\n  };\n\n  const searchPosts = async term => {\n    await axios.get(`http://localhost:3001/posts/search/${term}`).then(data => {\n      setPosts(data.data);\n      setFeed('search');\n    });\n  };\n\n  const addToList = async (user, post) => {\n    console.log(user.nickname, post);\n    await axios.get(`http://localhost:3001/users/${user.nickname}`).then(res => {\n      if (res.data[0]) {\n        axios.put(`http://localhost:3001/users/${user.nickname}`, {\n          reading: post\n        });\n      } else {\n        createUser(user.nickname, post);\n      }\n    });\n  };\n\n  const createUser = async (name, post) => {\n    await axios.post(`http://localhost:3001/users`, {\n      name: name,\n      reading: post\n    });\n  };\n\n  const getReadingList = async user => {\n    await axios.get(`http://localhost:3001/users/${user.nickname}`).then(res => {\n      const list = res.data[0].reading;\n      listHelper(list);\n    });\n  }; //part of get reading list and delete from list\n\n\n  const listHelper = async list => {\n    await axios.get(`http://localhost:3001/list`, {\n      params: {\n        list: list\n      }\n    }).then(res => {\n      setPosts(res.data);\n      setFeed('list');\n    });\n  };\n\n  const deleteFromList = async (user, postid) => {\n    await axios.put(`http://localhost:3001/list/${user.nickname}`, {\n      reading: postid\n    }).then(res => {\n      const list = res.data.reading;\n      listHelper(list);\n    });\n  };\n\n  const checkReadingList = async (user, postId) => {\n    return axios.get(`http://localhost:3001/users/${user.nickname}`).then(res => {\n      const list = res.data[0].reading;\n      console.log('checked the list!', list.includes(postId) ? true : false);\n      return list.includes(postId) ? true : false;\n    });\n  };\n\n  return __jsx(\"div\", {\n    className: \"app_body\"\n  }, __jsx(Dashboard, {\n    posts: posts,\n    tags: tags,\n    getPostByTag: getPostByTag,\n    addToList: addToList,\n    searchPosts: searchPosts,\n    feedState: feed,\n    getReadingList: getReadingList,\n    deleteFromList: deleteFromList,\n    checkReadingList: checkReadingList\n  }));\n}\n\nApp.getInitialProps = async ctx => {\n  const res = await axios.get('http://localhost:3001/posts');\n  const tags = await axios.get('http://localhost:3001/tags');\n  return {\n    postList: res.data,\n    tags: tags.data\n  };\n};\n\nexport default App;","map":null,"metadata":{},"sourceType":"module"}